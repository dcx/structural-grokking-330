

program: train_transformers.py
method: grid

metric: # not required for random search
  name: test_aux
  goal: maximize

parameters:
  save_dir:
    value: "/nlp/scr/mcgrathk/sweeps/231126_num_heads/"
  encoder_n_layers:
    values: [2, 3]
  vec_dim:
    value: 512
  n_heads:
    values: [1, 2, 4, 8, 16, 32]



command:
  - ${env}
  - ${interpreter}
  - ${program}
  - "--callback"
  - "--dataset=ds-addmult-mod10"
  - "--dsam_data_file=data_utils/ds_addmult_mod10_data/data-addmult-231102-1.5m.csv"
  - "--lm=True"
  - "--mode=lm"
  - "--eval_every=10000"

  - "--save_model"
  - "--save_interval=100000"

  - "--seed=10"
 
  - "--lr=0.0001"
  - "--weight_decay=0.16684086962884942"

  - "--max_train_steps=500000"
  - "--dsam_min_tree_height=1"
  - "--dsam_max_tree_height=6"
  - "--dsam_max_tree_width=80"
  - "--dsam_hold_out_p_subtrees=0.15"
  - "--dsam_hold_out_n_unique_examples=1000"
  - "--dsam_balance_depths"


  - "--relative=True"
  - "--wandb_user=kyle"
  - "--batch_size=32"
  - ${args}